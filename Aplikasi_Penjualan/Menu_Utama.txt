Private Sub Btn_Add_Transaksi_Click()
If Text_KodePelanggan_Transaksi <> "" And Text_KodeBarang_Transaksi <> "" _
And Text_Jumlah_Transaksi <> "" Then
  Dim SIMPAN As Object
    Set SIMPAN = Sheet5.Range("A10000").End(xlUp)
    SIMPAN.Offset(1, 0).Value = Label_Kode_Transaksi.Caption
    SIMPAN.Offset(1, 1).Value = Text_KodeBarang_Transaksi.Value
    SIMPAN.Offset(1, 2).Value = Text_NamaBarang_Transaksi.Value
    SIMPAN.Offset(1, 3).Value = Text_Merk_Transaksi.Value
    SIMPAN.Offset(1, 4).Value = Text_Harga_Transaksi.Value
    SIMPAN.Offset(1, 5).Value = Text_Jumlah_Transaksi.Value
    SIMPAN.Offset(1, 6).Value = Text_Total_Transaksi.Value
    Sheet5.Range("I8").Value = Label_Kode_Transaksi.Caption
    Sheet5.Range("I4").Value = Label_Kode_Transaksi.Caption
    Text_Subtotal_Transaksi.Value = Sheet5.Range("I9").Value
    Call Cari_Detail
    Text_KodeBarang_Transaksi = ""
    Text_NamaBarang_Transaksi = ""
    Text_Merk_Transaksi = ""
    Text_Harga_Transaksi = ""
    Text_Jumlah_Transaksi = ""
    Text_Total_Transaksi = ""
Else
  MsgBox "Silahkan isi Kode Pelanggan dan Kode Barang!", vbCritical, "Aplikasi Penjualan"
End If
End Sub

Private Sub btn_tambah_data_barang_Click()
UserForm_Barang.btnEdit.Visible = False
UserForm_Barang.btnHapus.Visible = False
UserForm_Barang.btnSimpan.Left = 198
UserForm_Barang.Show
End Sub

Private Sub btn_tambah_data_pelanggan_Click()
UserForm_Pelanggan.btnEdit.Visible = False
UserForm_Pelanggan.btnHapus.Visible = False
UserForm_Pelanggan.btnSimpan.Left = 204
UserForm_Pelanggan.Show
End Sub

Private Sub BtnHapus_Kategori_Click()
On Error GoTo error
Pesan = MsgBox("Data akan dihapus ?", vbQuestion + vbYesNo, "Hapus Data")
If Pesan = vbYes Then
  Dim dRow As Object
  Set dRow = Sheet3.Range("A2:A100000").Find(What:=Me.TextKode_Kategori, LookIn:=xlValues)
    dRow.Value = ""
    dRow.Offset(0, 1).Value = ""
    dRow.Offset(0, 2).Value = ""
    Call HAPUS_KATEGORI
    ListBox_Kategori.RowSource = Sheet3.Range("DATA_KATEGORI").Address(External:=True)
    MsgBox "Data baru berhasil dihapus!", vbInformation, "Aplikasi Penjualan"
    Call Bersih_Text
    Call Otomatis_Kategori
Else
  Call Bersih_Text
  Call Otomatis_Kategori
End If
Exit Sub
error:
  MsgBox "Silahkah pilih data yang akan dihapus!", vbCritical, "Aplikasi Penjualan"
End Sub

Private Sub BtnSimpan_Kategori_Click()
If TextKode_Kategori = "" Or TextKategori = "" Then
  MsgBox "Data masih ada yang kosong, silahkan lengkapi!", vbCritical, "Validasi Form"
Else
Dim SIMPAN As Object
Set SIMPAN = Sheet3.Range("A1000000").End(xlUp)
  SIMPAN.Offset(1, 0).Value = TextKode_Kategori.Value
  SIMPAN.Offset(1, 1).Value = TextKategori.Value
  SIMPAN.Offset(1, 2).Value = Date
  MsgBox "Data berhasil ditambahkan!", vbInformation, "Success"
  Call Bersih_Text
  Call Otomatis_Kategori
  Call Listbox
End If
End Sub

Private Sub comboKategori_Barang_Change()
Sheet1.Range("H7").Value = comboKategori_Barang.Value
If comboKategori_Barang <> "" Then
  textKeyword_barang.Locked = False
End If
End Sub

Private Sub comboKategori_Pelanggan_Change()
Sheet2.Range("H7").Value = comboKategori_Pelanggan.Value
If comboKategori_Pelanggan <> "" Then
  textKeyword_pelanggan.Locked = False
End If
End Sub

Private Sub Frame2_Click()

End Sub

Private Sub Label_Dashboard_Click()
MultiPage1.Value = 0
End Sub

Private Sub Label_Dashboard_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
  Label_Primary_Dashboard.Visible = True
  Label_Secondary_Dashboard.Visible = True
  Label_Primary_Manajemen_Barang.Visible = False
  Label_Secondary_Manajemen_Barang.Visible = False
  Label_Primary_Manajemen_Pelanggan.Visible = False
  Label_Secondary_Manajemen_Pelanggan.Visible = False
  Label_Primary_Manajemen_Kategori.Visible = False
  Label_Secondary_Manajemen_Kategori.Visible = False
  Label_Primary_Transaksi.Visible = False
  Label_Secondary_Transaksi.Visible = False
End Sub

Private Sub Label_Manajemen_Barang_Click()
MultiPage1.Value = 1
End Sub

Private Sub Label_Manajemen_Barang_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
  Label_Primary_Dashboard.Visible = False
  Label_Secondary_Dashboard.Visible = False
  Label_Primary_Manajemen_Barang.Visible = True
  Label_Secondary_Manajemen_Barang.Visible = True
  Label_Primary_Manajemen_Pelanggan.Visible = False
  Label_Secondary_Manajemen_Pelanggan.Visible = False
  Label_Primary_Manajemen_Kategori.Visible = False
  Label_Secondary_Manajemen_Kategori.Visible = False
  Label_Primary_Transaksi.Visible = False
  Label_Secondary_Transaksi.Visible = False
End Sub

Private Sub Label_Manajemen_Kategori_Click()
MultiPage1.Value = 3
End Sub

Private Sub Label_Manajemen_Kategori_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
  Label_Primary_Dashboard.Visible = False
  Label_Secondary_Dashboard.Visible = False
  Label_Primary_Manajemen_Barang.Visible = False
  Label_Secondary_Manajemen_Barang.Visible = False
  Label_Primary_Manajemen_Pelanggan.Visible = False
  Label_Secondary_Manajemen_Pelanggan.Visible = False
  Label_Primary_Manajemen_Kategori.Visible = True
  Label_Secondary_Manajemen_Kategori.Visible = True
  Label_Primary_Transaksi.Visible = False
  Label_Secondary_Transaksi.Visible = False
End Sub

Private Sub Label_Manajemen_Pelanggan_Click()
MultiPage1.Value = 2
End Sub

Private Sub Label_Manajemen_Pelanggan_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
  Label_Primary_Dashboard.Visible = False
  Label_Secondary_Dashboard.Visible = False
  Label_Primary_Manajemen_Barang.Visible = False
  Label_Secondary_Manajemen_Barang.Visible = False
  Label_Primary_Manajemen_Pelanggan.Visible = True
  Label_Secondary_Manajemen_Pelanggan.Visible = True
  Label_Primary_Manajemen_Kategori.Visible = False
  Label_Secondary_Manajemen_Kategori.Visible = False
  Label_Primary_Transaksi.Visible = False
  Label_Secondary_Transaksi.Visible = False
End Sub

Private Sub Label_Transaksi_Click()
MultiPage1.Value = 4
End Sub

Private Sub Label_Transaksi_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
  Label_Primary_Dashboard.Visible = False
  Label_Secondary_Dashboard.Visible = False
  Label_Primary_Manajemen_Barang.Visible = False
  Label_Secondary_Manajemen_Barang.Visible = False
  Label_Primary_Manajemen_Pelanggan.Visible = False
  Label_Secondary_Manajemen_Pelanggan.Visible = False
  Label_Primary_Manajemen_Kategori.Visible = False
  Label_Secondary_Manajemen_Kategori.Visible = False
  Label_Primary_Transaksi.Visible = True
  Label_Secondary_Transaksi.Visible = True
End Sub

Private Sub Label_Sidebar_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Call Menu_awal
End Sub

Private Sub Listbox_Barang_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
UserForm_Barang.textKodeBarang.Value = Me.Listbox_Barang.List(Me.Listbox_Barang.ListIndex, 0)
UserForm_Barang.textNamaBarang.Value = Me.Listbox_Barang.List(Me.Listbox_Barang.ListIndex, 1)
UserForm_Barang.comboKategori.Value = Me.Listbox_Barang.List(Me.Listbox_Barang.ListIndex, 2)
UserForm_Barang.textMerk.Value = Me.Listbox_Barang.List(Me.Listbox_Barang.ListIndex, 3)
UserForm_Barang.textHarga.Value = Me.Listbox_Barang.List(Me.Listbox_Barang.ListIndex, 4)
UserForm_Barang.textStok.Value = Me.Listbox_Barang.List(Me.Listbox_Barang.ListIndex, 5)
UserForm_Barang.btnSimpan.Visible = False
UserForm_Barang.Show
End Sub

Private Sub ListBox_Kategori_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
TextKode_Kategori.Value = Me.ListBox_Kategori.List(Me.ListBox_Kategori.ListIndex, 0)
TextKategori.Value = Me.ListBox_Kategori.List(Me.ListBox_Kategori.ListIndex, 1)
End Sub

Private Sub ListBox_Pelanggan_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
UserForm_Pelanggan.TextKode.Value = Me.ListBox_Pelanggan.List(Me.ListBox_Pelanggan.ListIndex, 0)
UserForm_Pelanggan.textNama.Value = Me.ListBox_Pelanggan.List(Me.ListBox_Pelanggan.ListIndex, 1)
If Me.ListBox_Pelanggan.List(Me.ListBox_Pelanggan.ListIndex, 2) = "Laki-laki" Then
  UserForm_Pelanggan.OptionLaki_laki.Value = True
Else
  UserForm_Pelanggan.OptionPerempuan.Value = True
End If
UserForm_Pelanggan.textAlamat.Value = Me.ListBox_Pelanggan.List(Me.ListBox_Pelanggan.ListIndex, 3)
UserForm_Pelanggan.textTelepon.Value = Me.ListBox_Pelanggan.List(Me.ListBox_Pelanggan.ListIndex, 4)
UserForm_Pelanggan.btnSimpan.Visible = False
UserForm_Pelanggan.Show
End Sub

Private Sub Text_Jumlah_Transaksi_Change()
Text_Total_Transaksi.Value = Val(Text_Harga_Transaksi) * Val(Text_Jumlah_Transaksi)
End Sub

Private Sub Text_KodeBarang_Transaksi_AfterUpdate()
Dim Cari As Object
On Error GoTo Salah
'proses pencarian data
Set Cari = Sheet1.Range("A4:A100000").Find(What:=Text_KodeBarang_Transaksi.Value, LookIn:=xlValues)
    'untuk menampilkan data ke textbox
    Text_NamaBarang_Transaksi.Value = Cari.Offset(0, 1).Value
    Text_Merk_Transaksi.Value = Cari.Offset(0, 3).Value
    Text_Harga_Transaksi.Value = Cari.Offset(0, 4).Value
    Text_Jumlah_Transaksi.SetFocus
Exit Sub
Salah:
MsgBox "Kode Pelanggan Tidak Ditemukan!", vbCritical, "Aplikasi!"
Text_KodeBarang_Transaksi = ""
Text_KodeBarang_Transaksi.SetFocus
End Sub

Private Sub Text_KodePelanggan_Transaksi_AfterUpdate()
Dim Cari As Object
On Error GoTo Salah
'proses pencarian data
Set Cari = Sheet2.Range("A4:A100000").Find(What:=Text_KodePelanggan_Transaksi.Value, LookIn:=xlValues)
    'untuk menampilkan data ke textbox
    Text_NamaPelanggan_Transaksi.Value = Cari.Offset(0, 1).Value
    Text_JenisKelamin_Transaksi.Value = Cari.Offset(0, 2).Value
    Text_Alamat_Transaksi.Value = Cari.Offset(0, 3).Value
    Text_Telepon_Transaksi = Cari.Offset(0, 4).Value
Exit Sub
Salah:
MsgBox "Kode Pelanggan Tidak Ditemukan!", vbCritical, "Aplikasi!"
Text_KodePelanggan_Transaksi = ""
Text_KodePelanggan_Transaksi.SetFocus
End Sub

Private Sub textKeyword_barang_Change()
On Error GoTo Salah
Sheet1.Range("H8").Value = textKeyword_barang.Value
Sheet1.Range("A3").CurrentRegion.AdvancedFilter Action:=xlFilterCopy, _
CriteriaRange:=Sheet1.Range("KRITERIA_BARANG"), CopyToRange:=Sheet1.Range("FILTER_BARANG"), Unique:=False
Call Lisbox_Filter
Exit Sub
Salah:
  MsgBox "Data yang dicari tidak ditemukan!!", vbCritical, "Aplikasi Penjualan"
End Sub

Private Sub UserForm_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Call Menu_awal
End Sub

Private Sub UserForm_Initialize()
Call Menu_awal
Call Bersih_Text
Call Listbox
Call Otomatis_Kategori
Call Kategori_Pencarian
Call Otomatis_Transaksi
End Sub

Sub Menu_awal()
  Label_Primary_Dashboard.Visible = False
  Label_Secondary_Dashboard.Visible = False
  Label_Primary_Manajemen_Barang.Visible = False
  Label_Secondary_Manajemen_Barang.Visible = False
  Label_Primary_Manajemen_Pelanggan.Visible = False
  Label_Secondary_Manajemen_Pelanggan.Visible = False
  Label_Primary_Manajemen_Kategori.Visible = False
  Label_Secondary_Manajemen_Kategori.Visible = False
  Label_Primary_Transaksi.Visible = False
  Label_Secondary_Transaksi.Visible = False
End Sub

Sub Listbox()
With Listbox_Barang
  .ColumnCount = 6
  .ColumnHeads = True
  .RowSource = Sheet1.Range("DATA_BARANG").Address(External:=True)
End With

With ListBox_Pelanggan
  .ColumnCount = 5
  .ColumnHeads = True
  .RowSource = Sheet2.Range("DATA_PELANGGAN").Address(External:=True)
End With

With ListBox_Kategori
  .ColumnCount = 3
  .ColumnHeads = True
  .RowSource = Sheet3.Range("DATA_KATEGORI").Address(External:=True)
End With
End Sub

Sub Bersih_Text()
'Kategori
TextKode_Kategori = ""
TextKategori = ""

'Pencarian Data Barang
textKeyword_barang = ""
textKeyword_barang.Locked = True

'Pencarian Data Pelanggan
textKeyword_pelanggan = ""
textKeyword_pelanggan.Locked = True

'Transaksi
Label_tgl_transaksi.Caption = ""
Label_tgl_transaksi.Caption = Date

Text_KodePelanggan_Transaksi = ""
Text_NamaPelanggan_Transaksi = ""
Text_JenisKelamin_Transaksi = ""
Text_Telepon_Transaksi = ""
Text_Alamat_Transaksi = ""
Text_NamaPelanggan_Transaksi.Locked = True
Text_JenisKelamin_Transaksi.Locked = True
Text_Telepon_Transaksi.Locked = True
Text_Alamat_Transaksi.Locked = True

Text_KodeBarang_Transaksi = ""
Text_NamaBarang_Transaksi = ""
Text_Merk_Transaksi = ""
Text_Harga_Transaksi = ""
Text_Jumlah_Transaksi = ""
Text_Total_Transaksi = ""
Text_NamaBarang_Transaksi.Locked = True
Text_Merk_Transaksi.Locked = True
Text_Harga_Transaksi.Locked = True
Text_Total_Transaksi.Locked = True

Text_Subtotal_Transaksi = ""
End Sub

Sub Kode_Terakhir_Kategori()
Dim KODE As Object
  Set KODE = Sheet3.Range("A1000000").End(xlUp)
  If KODE = "Kode" Then
    Sheet3.Range("E3").Value = 0
  Else
    Sheet3.Range("E3").Value = KODE.Offset(0, 0).Value
  End If
End Sub

Sub Otomatis_Kategori()
Call Kode_Terakhir_Kategori
If Sheet3.Range("E2").Value >= 99 Then
  TextKode_Kategori.Value = "K" & Sheet3.Range("E2").Value + 1
Else
  TextKode_Kategori.Value = "K0" & Sheet3.Range("E2").Value + 1
End If
TextKode_Kategori.Locked = True
End Sub

Sub Kode_Terakhir_Transaksi()
Dim KODE As Object
  Set KODE = Sheet4.Range("A1000000").End(xlUp)
  If KODE = "Kode Transaksi" Then
    Sheet4.Range("I5").Value = 0
  Else
    Sheet4.Range("I5").Value = KODE.Offset(0, 0).Value
  End If
End Sub

Sub Otomatis_Transaksi()
Call Kode_Terakhir_Transaksi
If Sheet4.Range("I4").Value >= 99 Then
  Label_Kode_Transaksi.Caption = "T-" & Format(Date, "yymmdd") & Sheet4.Range("I4") + 1
ElseIf Sheet4.Range("I4").Value >= 9 Then
  Label_Kode_Transaksi.Caption = "T-" & Format(Date, "yymmdd") & "0" & Sheet4.Range("I4") + 1
Else
  Label_Kode_Transaksi.Caption = "T-" & Format(Date, "yymmdd") & "00" & Sheet4.Range("I4") + 1
End If
End Sub

Sub Cari_Detail()
Sheet5.Range("A3").CurrentRegion.AdvancedFilter Action:=xlFilterCopy, _
CriteriaRange:=Sheet5.Range("KRITERIA_DETAIL"), CopyToRange:=Sheet5.Range("FILTER_DETAIL"), Unique:=False
Call Lisbox_Detail
End Sub
